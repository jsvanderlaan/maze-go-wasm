@let upload = upload$ | async;

<div class="mb-2">
    <app-example-upload (next)="onPreview($event)" />
</div>
<form>
    <div class="relative flex items-center justify-center w-full mb-4">
        @if (upload) {
            <div class="absolute top-0 left-0 h-52 w-full flex pointer-events-none">
                <img class="opacity-25 m-auto max-h-full" [src]="upload" />
            </div>
        }
        <label
            for="dropzone-file"
            class="flex flex-col items-center justify-center w-full h-52 border-2 border-dashed rounded-lg cursor-pointer bg-gray-800 border-gray-700 hover:bg-gray-700 hover:border-gray-600"
        >
            <div class="flex flex-col items-center justify-center pt-5 pb-6">
                <svg
                    class="w-8 h-8 mb-4 text-gray-400"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        d="M15.7955 15.8111L21 21M18 10.5C18 14.6421 14.6421 18 10.5 18C6.35786 18 3 14.6421 3 10.5C3 6.35786 6.35786 3 10.5 3C14.6421 3 18 6.35786 18 10.5Z"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                </svg>
                <p class="mb-2 text-sm text-gray-400"><span class="font-semibold">Click to choose</span> or drag and drop</p>
                <p class="text-xs text-gray-400">JPG, JPEG, PNG (MAX. 2MB)</p>
                @if (form.controls.image.errors && submitted()) {
                    <p class="text-xs text-red-500">
                        @if (form.controls.image.errors['required']) {
                            Required
                        } @else {
                            Invalid image: {{ form.controls.image.errors['image'] }}
                        }
                    </p>
                }
            </div>
            <input
                id="dropzone-file"
                type="file"
                class="hidden"
                [accept]="exceptedTypes.join(',')"
                (change)="onFileSelected($event)"
            />
        </label>
    </div>

    <div class="mb-4">
        <label for="height-input" class="block mb-2">Height</label>
        <input
            id="height-input"
            [formControl]="form.controls.height"
            type="number"
            [min]="1"
            [max]="1000"
            [value]="defaultHeight"
            class="rounded-lg text-black pl-1 py-1 accent-green-600"
        />
        @if (form.controls.height.errors && submitted()) {
            <p class="text-xs text-red-500 mt-1">Must be a valid number between {{ minHeight }} and {{ maxHeight }}.</p>
        }
    </div>
    <div class="mb-4">
        <label class="block mb-2">Threshold</label>
        <div class="flex justify-between w-full">
            <span class="text-sm mr-4">{{ form.controls.threshold.value | number: '1.3-3' }}</span>
            <input
                [formControl]="form.controls.threshold"
                type="range"
                [min]="minThreshold"
                [max]="maxThreshold"
                step="0.005"
                [value]="defaultThreshold"
                class="my-auto w-full appearance-none h-2 bg-gray-700 rounded-full accent-green-500"
            />
        </div>
    </div>

    <button type="button" (click)="onSubmit()" class="px-4 py-1 bg-green-600 rounded hover:bg-green-500">Create maze</button>
</form>
